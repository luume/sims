<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
<mapper namespace="com.nexmore.sims.excel.mapper.ExcelMapper">
    <insert id="saveExcel" parameterType="java.util.List">
        INSERT INTO excel_test VALUES
        <foreach collection="list" item="item" separator=",">
            (#{item.EQP_ID}, #{item.SVC_NAME}, #{item.IP_ADDRESS}, #{item.USER_ID})
        </foreach>
    </insert>

    <select id="isTangoEqpId" parameterType="String">
        SELECT
            COUNT(*)
        FROM
            ti_basic_manage_info_tm
        WHERE TI_SYNC = '1'
            AND EQP_ID = #{eqpId}
            AND IP_ADDRESS  REGEXP '^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$'
    </select>

    <select id="isIpAddress" parameterType="String">
        SELECT
            COUNT(*)
        FROM
            ti_basic_manage_info_tm
        WHERE TI_SYNC = '1'
          AND EQP_ID = #{eqpId}
          AND IP_ADDRESS  REGEXP '^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$'
    </select>

    <select id="isEqpId" parameterType="String">
        SELECT
            COUNT(*)
        FROM
            ti_access_info_tm
        WHERE 1 = 1
            AND EQP_ID = #{eqpId}
    </select>

</mapper>